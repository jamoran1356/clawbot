services:
  clawbot:
    build:
      context: .
      dockerfile: Dockerfile
    container_name: clawbot
    environment:
      - CLAWDBOT_WORKSPACE=/workspace
      - BRAVE_API_KEY=${BRAVE_API_KEY}
      - OPENROUTER_API_KEY=${OPENROUTER_API_KEY}
      - MODEL=${MODEL}
      - GATEWAY_MODE=${GATEWAY_MODE}

    volumes:
      # Un solo volumen de trabajo - simple y directo
      - ./workspace:/workspace
      # Directorio clawd para acceso directo
      - ./clawd:/home/node/clawd
      # Configuraci√≥n persistente (volumen existente con datos)
      - clawbot_config:/root/.clawdbot
      # Socket de Docker para que clawbot pueda ejecutar contenedores
      - /var/run/docker.sock:/var/run/docker.sock
    ports:
      - "19000:19000"
    stdin_open: true
    tty: true
    working_dir: /workspace
    restart: unless-stopped

volumes:
  clawbot_config:
    external: true
